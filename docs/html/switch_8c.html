<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
<title>LITM: project/src/switch.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css">
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.5.8 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="main.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li><a href="annotated.html"><span>Data&nbsp;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="files.html"><span>File&nbsp;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
</div>
<div class="contents">
<h1>project/src/switch.c File Reference</h1><code>#include &lt;stdlib.h&gt;</code><br>
<code>#include &lt;pthread.h&gt;</code><br>
<code>#include &lt;errno.h&gt;</code><br>
<code>#include &lt;sys/types.h&gt;</code><br>
<code>#include &quot;<a class="el" href="litm_8h-source.html">litm.h</a>&quot;</code><br>
<code>#include &quot;<a class="el" href="switch_8h-source.html">switch.h</a>&quot;</code><br>
<code>#include &quot;<a class="el" href="queue_8h-source.html">queue.h</a>&quot;</code><br>
<code>#include &quot;<a class="el" href="pool_8h-source.html">pool.h</a>&quot;</code><br>
<code>#include &quot;<a class="el" href="connection_8h-source.html">connection.h</a>&quot;</code><br>
<code>#include &quot;<a class="el" href="logger_8h-source.html">logger.h</a>&quot;</code><br>

<p>
<div class="dynheader">
Include dependency graph for switch.c:</div>
<div class="dynsection">
<p><center><img src="switch_8c__incl.png" border="0" usemap="#project/src/switch.c_map" alt=""></center>
<map name="project/src/switch.c_map">
<area shape="rect" href="litm_8h.html" title="litm.h" alt="" coords="291,155,344,181"><area shape="rect" href="switch_8h.html" title="switch.h" alt="" coords="5,155,75,181"><area shape="rect" href="queue_8h.html" title="queue.h" alt="" coords="245,80,312,107"><area shape="rect" href="pool_8h.html" title="pool.h" alt="" coords="700,80,756,107"><area shape="rect" href="connection_8h.html" title="connection.h" alt="" coords="780,80,876,107"><area shape="rect" href="logger_8h.html" title="logger.h" alt="" coords="437,80,504,107"></map>
</div>

<p>
<a href="switch_8c-source.html">Go to the source code of this file.</a><table border="0" cellpadding="0" cellspacing="0">
<tr><td></td></tr>
<tr><td colspan="2"><br><h2>Defines</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="switch_8c.html#8afcad0976aea522c9fd16b11b49d14d">LITM_SHUTDOWN_FLAG_TRUE</a>&nbsp;&nbsp;&nbsp;1</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="switch_8c.html#c3ba55abd7cb01bec78ad24348561d4e">LITM_SHUTDOWN_FLAG_FALSE</a>&nbsp;&nbsp;&nbsp;0</td></tr>

<tr><td colspan="2"><br><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="switch_8c.html#99ec0a50e5e594cb656f9ea1f7d39554">__switch_thread_function</a> (void *params)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="litm_8h.html#a1c70492a41df506aa1156ea7d36c4de">litm_code</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="switch_8c.html#4d51cfe83ccbbb9248bbee852a1a3a65">__switch_get_next_subscriber</a> (<a class="el" href="struct__litm__connection.html">litm_connection</a> **result, int *result_index, <a class="el" href="struct__litm__connection.html">litm_connection</a> *sender, int current, <a class="el" href="litm_8h.html#e7fcc1b5cd037f318d4fe40a2f9d30d3">litm_bus</a> bus_id)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="switch_8c.html#789e706afab00720920bef8347ac87af">__switch_find_match</a> (<a class="el" href="struct__litm__connection.html">litm_connection</a> *sender, int ref, <a class="el" href="litm_8h.html#e7fcc1b5cd037f318d4fe40a2f9d30d3">litm_bus</a> bus_id)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="litm_8h.html#a1c70492a41df506aa1156ea7d36c4de">litm_code</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="switch_8c.html#1025953257d7d23c8473d945dbf0c9db">__switch_try_sending_to_recipient</a> (<a class="el" href="struct__litm__connection.html">litm_connection</a> *recipient, <a class="el" href="struct__litm__envelope.html">litm_envelope</a> *env)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="litm_8h.html#a1c70492a41df506aa1156ea7d36c4de">litm_code</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="switch_8c.html#149e07f06e61c0daee8f4cf38200dff2">__switch_finalize</a> (<a class="el" href="struct__litm__envelope.html">litm_envelope</a> *envlp)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="litm_8h.html#a1c70492a41df506aa1156ea7d36c4de">litm_code</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="switch_8c.html#a915fa62ee3a445f9acac19e744005e3">__switch_try_sending_or_requeue</a> (<a class="el" href="struct__litm__connection.html">litm_connection</a> *conn, <a class="el" href="struct__litm__envelope.html">litm_envelope</a> *envlp)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="switch_8c.html#e4d3d02052899f64d09070f18f75c29a">__switch_init_tables</a> (void)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="switch_8c.html#195303a03d0b0c2a3f44951a38b2b0f6">__switch_handle_pending</a> (<a class="el" href="struct__litm__envelope.html">litm_envelope</a> *e)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="litm_8h.html#a1c70492a41df506aa1156ea7d36c4de">litm_code</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="switch_8c.html#9b8ef3fb85a6655628b2e534bc7e4245">__switch_safe_send</a> (<a class="el" href="struct__litm__connection.html">litm_connection</a> *conn, <a class="el" href="litm_8h.html#e7fcc1b5cd037f318d4fe40a2f9d30d3">litm_bus</a> bus_id, void *msg, void(*cleaner)(void *msg), int shutdown_flag)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="struct__litm__connection.html">litm_connection</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="switch_8c.html#552ed4039852ff10cf5e4fdb294075fa">__switch_index_to_connection</a> (int bus_id, int index)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="switch_8c.html#cf83bfcffad6990c781b1a668ec8209e">switch_init</a> (void)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="switch_8c.html#21156cec60e58e66f5d409c0cfbcfb12">__switch_wait_shutdown</a> (void)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="litm_8h.html#a1c70492a41df506aa1156ea7d36c4de">litm_code</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="switch_8c.html#2bab91639e612d51d0d7d8a3a64d0ace">switch_release</a> (<a class="el" href="struct__litm__connection.html">litm_connection</a> *conn, <a class="el" href="struct__litm__envelope.html">litm_envelope</a> *envlp)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="litm_8h.html#a1c70492a41df506aa1156ea7d36c4de">litm_code</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="switch_8c.html#c5408c5b37244e5d0fe17f55f1c3f89e">switch_add_subscriber</a> (<a class="el" href="struct__litm__connection.html">litm_connection</a> *conn, <a class="el" href="litm_8h.html#e7fcc1b5cd037f318d4fe40a2f9d30d3">litm_bus</a> bus_id)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="litm_8h.html#a1c70492a41df506aa1156ea7d36c4de">litm_code</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="switch_8c.html#a12d12ec55e370e7b2d960a67ab19078">switch_remove_subscriber</a> (<a class="el" href="struct__litm__connection.html">litm_connection</a> *conn, <a class="el" href="litm_8h.html#e7fcc1b5cd037f318d4fe40a2f9d30d3">litm_bus</a> bus_id)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="litm_8h.html#a1c70492a41df506aa1156ea7d36c4de">litm_code</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="switch_8c.html#cc4861fecbb5d0b20174fc1513539554">switch_send_shutdown</a> (<a class="el" href="struct__litm__connection.html">litm_connection</a> *conn, <a class="el" href="litm_8h.html#e7fcc1b5cd037f318d4fe40a2f9d30d3">litm_bus</a> bus_id, void *msg, void(*cleaner)(void *msg))</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="litm_8h.html#a1c70492a41df506aa1156ea7d36c4de">litm_code</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="switch_8c.html#7ff2d602f713f81e854c172e842afcad">switch_send</a> (<a class="el" href="struct__litm__connection.html">litm_connection</a> *conn, <a class="el" href="litm_8h.html#e7fcc1b5cd037f318d4fe40a2f9d30d3">litm_bus</a> bus_id, void *msg, void(*cleaner)(void *msg))</td></tr>

<tr><td colspan="2"><br><h2>Variables</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="structqueue.html">queue</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="switch_8c.html#45d2c8f54ca279893a75408e9164be6a">_switch_queue</a></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">pthread_t&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="switch_8c.html#cb3ec39b5454e93fd98267ce8a0d7bab">_switchThread</a></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="switch_8c.html#d8504e0696f737980aafecd01c559839">_switchThread_status</a> = 0</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">pthread_mutex_t&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="switch_8c.html#66b222465cf692f5b9da017fa259dda1">_subscribers_mutex</a> = PTHREAD_MUTEX_INITIALIZER</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="struct__litm__connection.html">litm_connection</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="switch_8c.html#21322c5d86d64dd361bd78848c7355d6">_subscribers</a> [LITM_BUSSES_MAX][LITM_CONNECTION_MAX+1]</td></tr>

</table>
<hr><a name="_details"></a><h2>Detailed Description</h2>
<dl class="date" compact><dt><b>Date:</b></dt><dd>2009-04-25 </dd></dl>
<dl class="author" compact><dt><b>Author:</b></dt><dd>Jean-Lou Dupont</dd></dl>
<h2><a class="anchor" name="Overview">
Overview</a></h2>
This source implements the *switch* function whereby *envelopes* are presented, turn-wise, to each recipient(s) subscribing to a particular *bus*. 
<p>Definition in file <a class="el" href="switch_8c-source.html">switch.c</a>.</p>
<hr><h2>Define Documentation</h2>
<a class="anchor" name="c3ba55abd7cb01bec78ad24348561d4e"></a><!-- doxytag: member="switch.c::LITM_SHUTDOWN_FLAG_FALSE" ref="c3ba55abd7cb01bec78ad24348561d4e" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define LITM_SHUTDOWN_FLAG_FALSE&nbsp;&nbsp;&nbsp;0          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>Definition at line <a class="el" href="switch_8c-source.html#l00028">28</a> of file <a class="el" href="switch_8c-source.html">switch.c</a>.</p>

<p>Referenced by <a class="el" href="switch_8c-source.html#l00603">__switch_safe_send()</a>, <a class="el" href="switch_8c-source.html#l00111">__switch_thread_function()</a>, <a class="el" href="switch_8c-source.html#l00426">__switch_try_sending_to_recipient()</a>, and <a class="el" href="switch_8c-source.html#l00587">switch_send()</a>.</p>

</div>
</div><p>
<a class="anchor" name="8afcad0976aea522c9fd16b11b49d14d"></a><!-- doxytag: member="switch.c::LITM_SHUTDOWN_FLAG_TRUE" ref="8afcad0976aea522c9fd16b11b49d14d" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define LITM_SHUTDOWN_FLAG_TRUE&nbsp;&nbsp;&nbsp;1          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>Definition at line <a class="el" href="switch_8c-source.html#l00027">27</a> of file <a class="el" href="switch_8c-source.html">switch.c</a>.</p>

<p>Referenced by <a class="el" href="switch_8c-source.html#l00603">__switch_safe_send()</a>, <a class="el" href="switch_8c-source.html#l00111">__switch_thread_function()</a>, <a class="el" href="switch_8c-source.html#l00426">__switch_try_sending_to_recipient()</a>, and <a class="el" href="switch_8c-source.html#l00563">switch_send_shutdown()</a>.</p>

</div>
</div><p>
<hr><h2>Function Documentation</h2>
<a class="anchor" name="149e07f06e61c0daee8f4cf38200dff2"></a><!-- doxytag: member="switch.c::__switch_finalize" ref="149e07f06e61c0daee8f4cf38200dff2" args="(litm_envelope *envlp)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="litm_8h.html#a1c70492a41df506aa1156ea7d36c4de">litm_code</a> __switch_finalize           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct__litm__envelope.html">litm_envelope</a> *&nbsp;</td>
          <td class="paramname"> <em>envlp</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Finalizes a message contained in an envelope &amp; recycles the envelope 
<p>Definition at line <a class="el" href="switch_8c-source.html#l00689">689</a> of file <a class="el" href="switch_8c-source.html">switch.c</a>.</p>

<p>References <a class="el" href="pool_8c-source.html#l00047">__litm_pool_recycle()</a>, <a class="el" href="struct__litm__envelope.html#9e1e2e92283fc88e458ab22c80ed5a10">_litm_envelope::cleaner</a>, <a class="el" href="logger_8h-source.html#l00019">DEBUG_LOG</a>, <a class="el" href="litm_8h-source.html#l00302">LITM_CODE_ERROR_INVALID_ENVELOPE</a>, <a class="el" href="litm_8h-source.html#l00289">LITM_CODE_OK</a>, and <a class="el" href="litm_8h-source.html#l00343">_litm_envelope::msg</a>.</p>

<p>Referenced by <a class="el" href="switch_8c-source.html#l00292">__switch_handle_pending()</a>, <a class="el" href="switch_8c-source.html#l00111">__switch_thread_function()</a>, and <a class="el" href="switch_8c-source.html#l00343">switch_release()</a>.</p>

<p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dynsection">
<p><center><img src="switch_8c_149e07f06e61c0daee8f4cf38200dff2_cgraph.png" border="0" usemap="#switch_8c_149e07f06e61c0daee8f4cf38200dff2_cgraph_map" alt=""></center>
<map name="switch_8c_149e07f06e61c0daee8f4cf38200dff2_cgraph_map">
<area shape="rect" href="pool_8c.html#1266647a6ed7c20e9c5d08f4bef09dd3" title="__litm_pool_recycle" alt="" coords="173,5,309,32"><area shape="rect" href="pool_8c.html#2f844d6f6d2a471a5a93c3c49c28eef2" title="__litm_pool_destroy" alt="" coords="359,5,495,32"></map>
</div>

<p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dynsection">
<p><center><img src="switch_8c_149e07f06e61c0daee8f4cf38200dff2_icgraph.png" border="0" usemap="#switch_8c_149e07f06e61c0daee8f4cf38200dff2_icgraph_map" alt=""></center>
<map name="switch_8c_149e07f06e61c0daee8f4cf38200dff2_icgraph_map">
<area shape="rect" href="switch_8c.html#195303a03d0b0c2a3f44951a38b2b0f6" title="__switch_handle_pending" alt="" coords="175,5,343,32"><area shape="rect" href="switch_8c.html#99ec0a50e5e594cb656f9ea1f7d39554" title="__switch_thread_function" alt="" coords="392,31,560,57"><area shape="rect" href="switch_8h.html#2bab91639e612d51d0d7d8a3a64d0ace" title="switch_release" alt="" coords="205,107,312,133"><area shape="rect" href="switch_8h.html#cf83bfcffad6990c781b1a668ec8209e" title="switch_init" alt="" coords="608,31,691,57"><area shape="rect" href="litm_8h.html#7866d99d291588a5279844f2883fd3fa" title="litm_connect_ex" alt="" coords="740,31,855,57"><area shape="rect" href="litm_8h.html#bc852d2eb14353e36adf21c33eab03a3" title="litm_connect" alt="" coords="929,5,1025,32"><area shape="rect" href="litm_8h.html#eff57ac5ec37914599624703229ba8ca" title="litm_connect_ex_wait" alt="" coords="904,56,1051,83"><area shape="rect" href="litm_8h.html#21def412c9b064fc929e0822f28d2a2a" title="litm_release" alt="" coords="431,107,521,133"></map>
</div>

</div>
</div><p>
<a class="anchor" name="789e706afab00720920bef8347ac87af"></a><!-- doxytag: member="switch.c::__switch_find_match" ref="789e706afab00720920bef8347ac87af" args="(litm_connection *sender, int ref, litm_bus bus_id)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int __switch_find_match           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct__litm__connection.html">litm_connection</a> *&nbsp;</td>
          <td class="paramname"> <em>sender</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>ref</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="litm_8h.html#e7fcc1b5cd037f318d4fe40a2f9d30d3">litm_bus</a>&nbsp;</td>
          <td class="paramname"> <em>bus_id</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Find ``match``<p>
THIS FUNCTION IS NOT *CONNECTION SAFE* and thus must be called whilst holding the _connections lock. 
<p>Definition at line <a class="el" href="switch_8c-source.html#l00787">787</a> of file <a class="el" href="switch_8c-source.html">switch.c</a>.</p>

<p>References <a class="el" href="litm_8h-source.html#l00200">LITM_CONNECTION_MAX</a>.</p>

<p>Referenced by <a class="el" href="switch_8c-source.html#l00735">__switch_get_next_subscriber()</a>.</p>

<p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dynsection">
<p><center><img src="switch_8c_789e706afab00720920bef8347ac87af_icgraph.png" border="0" usemap="#switch_8c_789e706afab00720920bef8347ac87af_icgraph_map" alt=""></center>
<map name="switch_8c_789e706afab00720920bef8347ac87af_icgraph_map">
<area shape="rect" href="switch_8c.html#4d51cfe83ccbbb9248bbee852a1a3a65" title="__switch_get_next_subscriber" alt="" coords="199,31,393,57"><area shape="rect" href="switch_8c.html#99ec0a50e5e594cb656f9ea1f7d39554" title="__switch_thread_function" alt="" coords="443,31,611,57"><area shape="rect" href="switch_8h.html#cf83bfcffad6990c781b1a668ec8209e" title="switch_init" alt="" coords="659,31,741,57"><area shape="rect" href="litm_8h.html#7866d99d291588a5279844f2883fd3fa" title="litm_connect_ex" alt="" coords="791,31,905,57"><area shape="rect" href="litm_8h.html#bc852d2eb14353e36adf21c33eab03a3" title="litm_connect" alt="" coords="980,5,1076,32"><area shape="rect" href="litm_8h.html#eff57ac5ec37914599624703229ba8ca" title="litm_connect_ex_wait" alt="" coords="955,56,1101,83"></map>
</div>

</div>
</div><p>
<a class="anchor" name="4d51cfe83ccbbb9248bbee852a1a3a65"></a><!-- doxytag: member="switch.c::__switch_get_next_subscriber" ref="4d51cfe83ccbbb9248bbee852a1a3a65" args="(litm_connection **result, int *result_index, litm_connection *sender, int current, litm_bus bus_id)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="litm_8h.html#a1c70492a41df506aa1156ea7d36c4de">litm_code</a> __switch_get_next_subscriber           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct__litm__connection.html">litm_connection</a> **&nbsp;</td>
          <td class="paramname"> <em>result</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&nbsp;</td>
          <td class="paramname"> <em>result_index</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct__litm__connection.html">litm_connection</a> *&nbsp;</td>
          <td class="paramname"> <em>sender</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>current</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="litm_8h.html#e7fcc1b5cd037f318d4fe40a2f9d30d3">litm_bus</a>&nbsp;</td>
          <td class="paramname"> <em>bus_id</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Scans the subscription map for the subscriber that follows ``current``. If ``current`` is NULL (thus indicating the start of the scan), then pull the first subscriber from the subscription to bus ``bus_id``.<p>
Furthermore, we are implementing ``split horizon`` forwarding ie. don't send the message back to the originator.<p>
If end of list is reached, return NULL.<p>
CASES: ======<p>
1- empty subscription list 2- single subscriber a) the sender b) other subscriber 3- more than 1 subscriber 
<p>Definition at line <a class="el" href="switch_8c-source.html#l00735">735</a> of file <a class="el" href="switch_8c-source.html">switch.c</a>.</p>

<p>References <a class="el" href="switch_8c-source.html#l00787">__switch_find_match()</a>, <a class="el" href="litm_8h-source.html#l00307">LITM_CODE_ERROR_END_OF_SUBSCRIBERS_LIST</a>, and <a class="el" href="litm_8h-source.html#l00289">LITM_CODE_OK</a>.</p>

<p>Referenced by <a class="el" href="switch_8c-source.html#l00111">__switch_thread_function()</a>.</p>

<p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dynsection">
<p><center><img src="switch_8c_4d51cfe83ccbbb9248bbee852a1a3a65_cgraph.png" border="0" usemap="#switch_8c_4d51cfe83ccbbb9248bbee852a1a3a65_cgraph_map" alt=""></center>
<map name="switch_8c_4d51cfe83ccbbb9248bbee852a1a3a65_cgraph_map">
<area shape="rect" href="switch_8c.html#789e706afab00720920bef8347ac87af" title="__switch_find_match" alt="" coords="251,5,395,32"></map>
</div>

<p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dynsection">
<p><center><img src="switch_8c_4d51cfe83ccbbb9248bbee852a1a3a65_icgraph.png" border="0" usemap="#switch_8c_4d51cfe83ccbbb9248bbee852a1a3a65_icgraph_map" alt=""></center>
<map name="switch_8c_4d51cfe83ccbbb9248bbee852a1a3a65_icgraph_map">
<area shape="rect" href="switch_8c.html#99ec0a50e5e594cb656f9ea1f7d39554" title="__switch_thread_function" alt="" coords="251,31,419,57"><area shape="rect" href="switch_8h.html#cf83bfcffad6990c781b1a668ec8209e" title="switch_init" alt="" coords="467,31,549,57"><area shape="rect" href="litm_8h.html#7866d99d291588a5279844f2883fd3fa" title="litm_connect_ex" alt="" coords="599,31,713,57"><area shape="rect" href="litm_8h.html#bc852d2eb14353e36adf21c33eab03a3" title="litm_connect" alt="" coords="788,5,884,32"><area shape="rect" href="litm_8h.html#eff57ac5ec37914599624703229ba8ca" title="litm_connect_ex_wait" alt="" coords="763,56,909,83"></map>
</div>

</div>
</div><p>
<a class="anchor" name="195303a03d0b0c2a3f44951a38b2b0f6"></a><!-- doxytag: member="switch.c::__switch_handle_pending" ref="195303a03d0b0c2a3f44951a38b2b0f6" args="(litm_envelope *e)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void __switch_handle_pending           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct__litm__envelope.html">litm_envelope</a> *&nbsp;</td>
          <td class="paramname"> <em>e</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Handle ``pending`` requests to sent 
<p>Definition at line <a class="el" href="switch_8c-source.html#l00292">292</a> of file <a class="el" href="switch_8c-source.html">switch.c</a>.</p>

<p>References <a class="el" href="switch_8c-source.html#l00689">__switch_finalize()</a>, <a class="el" href="switch_8c-source.html#l00385">__switch_try_sending_or_requeue()</a>, <a class="el" href="logger_8h-source.html#l00019">DEBUG_LOG</a>, <a class="el" href="litm_8h-source.html#l00305">LITM_CODE_BUSY_CONNECTIONS</a>, <a class="el" href="litm_8h-source.html#l00301">LITM_CODE_BUSY_OUTPUT_QUEUE</a>, <a class="el" href="litm_8h-source.html#l00294">LITM_CODE_ERROR_BAD_CONNECTION</a>, <a class="el" href="litm_8h-source.html#l00289">LITM_CODE_OK</a>, <a class="el" href="litm_8c-source.html#l00320">litm_translate_code()</a>, and <a class="el" href="litm_8h-source.html#l00342">_litm_envelope::routes</a>.</p>

<p>Referenced by <a class="el" href="switch_8c-source.html#l00111">__switch_thread_function()</a>.</p>

<p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dynsection">
<p><center><img src="switch_8c_195303a03d0b0c2a3f44951a38b2b0f6_cgraph.png" border="0" usemap="#switch_8c_195303a03d0b0c2a3f44951a38b2b0f6_cgraph_map" alt=""></center>
<map name="switch_8c_195303a03d0b0c2a3f44951a38b2b0f6_cgraph_map">
<area shape="rect" href="switch_8c.html#149e07f06e61c0daee8f4cf38200dff2" title="__switch_finalize" alt="" coords="273,5,393,32"><area shape="rect" href="switch_8c.html#a915fa62ee3a445f9acac19e744005e3" title="__switch_try_sending_or_requeue" alt="" coords="225,56,441,83"><area shape="rect" href="litm_8c.html#76f700b9bb8531fd8baf8931e67c4604" title="litm_translate_code" alt="" coords="267,107,400,133"><area shape="rect" href="pool_8c.html#1266647a6ed7c20e9c5d08f4bef09dd3" title="__litm_pool_recycle" alt="" coords="533,5,669,32"><area shape="rect" href="pool_8c.html#2f844d6f6d2a471a5a93c3c49c28eef2" title="__litm_pool_destroy" alt="" coords="765,5,901,32"><area shape="rect" href="switch_8c.html#1025953257d7d23c8473d945dbf0c9db" title="__switch_try_sending_to_recipient" alt="" coords="492,107,711,133"><area shape="rect" href="queue_8c.html#8ef73c0a37ef99ebc486eaa88bd19cef" title="queue_put_head" alt="" coords="544,56,659,83"><area shape="rect" href="queue_8c.html#6771a5883953007fe2dc632d7c56cc98" title="queue_put_head_wait" alt="" coords="760,107,907,133"><area shape="rect" href="queue_8c.html#ad63e2d2e97a079465ca5651b5b7c36e" title="queue_put_nb" alt="" coords="783,157,884,184"><area shape="rect" href="queue_8c.html#145cb346a7b7660c1fdf011298d6ff5d" title="queue_put_head_safe" alt="" coords="956,81,1103,108"><area shape="rect" href="queue_8c.html#24e3c9aaef201f1f66bcd8591b1e4c15" title="queue_put_safe" alt="" coords="973,157,1085,184"></map>
</div>

<p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dynsection">
<p><center><img src="switch_8c_195303a03d0b0c2a3f44951a38b2b0f6_icgraph.png" border="0" usemap="#switch_8c_195303a03d0b0c2a3f44951a38b2b0f6_icgraph_map" alt=""></center>
<map name="switch_8c_195303a03d0b0c2a3f44951a38b2b0f6_icgraph_map">
<area shape="rect" href="switch_8c.html#99ec0a50e5e594cb656f9ea1f7d39554" title="__switch_thread_function" alt="" coords="224,31,392,57"><area shape="rect" href="switch_8h.html#cf83bfcffad6990c781b1a668ec8209e" title="switch_init" alt="" coords="440,31,523,57"><area shape="rect" href="litm_8h.html#7866d99d291588a5279844f2883fd3fa" title="litm_connect_ex" alt="" coords="572,31,687,57"><area shape="rect" href="litm_8h.html#bc852d2eb14353e36adf21c33eab03a3" title="litm_connect" alt="" coords="761,5,857,32"><area shape="rect" href="litm_8h.html#eff57ac5ec37914599624703229ba8ca" title="litm_connect_ex_wait" alt="" coords="736,56,883,83"></map>
</div>

</div>
</div><p>
<a class="anchor" name="552ed4039852ff10cf5e4fdb294075fa"></a><!-- doxytag: member="switch.c::__switch_index_to_connection" ref="552ed4039852ff10cf5e4fdb294075fa" args="(int bus_id, int index)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="struct__litm__connection.html">litm_connection</a> * __switch_index_to_connection           </td>
          <td>(</td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>bus_id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>index</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>Definition at line <a class="el" href="switch_8c-source.html#l00809">809</a> of file <a class="el" href="switch_8c-source.html">switch.c</a>.</p>

</div>
</div><p>
<a class="anchor" name="e4d3d02052899f64d09070f18f75c29a"></a><!-- doxytag: member="switch.c::__switch_init_tables" ref="e4d3d02052899f64d09070f18f75c29a" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void __switch_init_tables           </td>
          <td>(</td>
          <td class="paramtype">void&nbsp;</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>Definition at line <a class="el" href="switch_8c-source.html#l00084">84</a> of file <a class="el" href="switch_8c-source.html">switch.c</a>.</p>

<p>References <a class="el" href="litm_8h-source.html#l00201">LITM_BUSSES_MAX</a>, and <a class="el" href="litm_8h-source.html#l00200">LITM_CONNECTION_MAX</a>.</p>

<p>Referenced by <a class="el" href="switch_8c-source.html#l00067">switch_init()</a>.</p>

<p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dynsection">
<p><center><img src="switch_8c_e4d3d02052899f64d09070f18f75c29a_icgraph.png" border="0" usemap="#switch_8c_e4d3d02052899f64d09070f18f75c29a_icgraph_map" alt=""></center>
<map name="switch_8c_e4d3d02052899f64d09070f18f75c29a_icgraph_map">
<area shape="rect" href="switch_8h.html#cf83bfcffad6990c781b1a668ec8209e" title="switch_init" alt="" coords="192,31,275,57"><area shape="rect" href="litm_8h.html#7866d99d291588a5279844f2883fd3fa" title="litm_connect_ex" alt="" coords="324,31,439,57"><area shape="rect" href="litm_8h.html#bc852d2eb14353e36adf21c33eab03a3" title="litm_connect" alt="" coords="513,5,609,32"><area shape="rect" href="litm_8h.html#eff57ac5ec37914599624703229ba8ca" title="litm_connect_ex_wait" alt="" coords="488,56,635,83"></map>
</div>

</div>
</div><p>
<a class="anchor" name="9b8ef3fb85a6655628b2e534bc7e4245"></a><!-- doxytag: member="switch.c::__switch_safe_send" ref="9b8ef3fb85a6655628b2e534bc7e4245" args="(litm_connection *conn, litm_bus bus_id, void *msg, void(*cleaner)(void *msg), int shutdown_flag)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="litm_8h.html#a1c70492a41df506aa1156ea7d36c4de">litm_code</a> __switch_safe_send           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct__litm__connection.html">litm_connection</a> *&nbsp;</td>
          <td class="paramname"> <em>conn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="litm_8h.html#e7fcc1b5cd037f318d4fe40a2f9d30d3">litm_bus</a>&nbsp;</td>
          <td class="paramname"> <em>bus_id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&nbsp;</td>
          <td class="paramname"> <em>msg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void(*)(void *msg)&nbsp;</td>
          <td class="paramname"> <em>cleaner</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>shutdown_flag</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>Definition at line <a class="el" href="switch_8c-source.html#l00603">603</a> of file <a class="el" href="switch_8c-source.html">switch.c</a>.</p>

<p>References <a class="el" href="pool_8c-source.html#l00081">__litm_pool_get()</a>, <a class="el" href="pool_8c-source.html#l00047">__litm_pool_recycle()</a>, <a class="el" href="struct__litm__envelope.html#9e1e2e92283fc88e458ab22c80ed5a10">_litm_envelope::cleaner</a>, <a class="el" href="litm_8h-source.html#l00340">_litm_envelope::delivery_count</a>, <a class="el" href="litm_8h-source.html#l00291">LITM_CODE_BUSY</a>, <a class="el" href="litm_8h-source.html#l00292">LITM_CODE_ERROR_MALLOC</a>, <a class="el" href="litm_8h-source.html#l00289">LITM_CODE_OK</a>, <a class="el" href="switch_8c-source.html#l00028">LITM_SHUTDOWN_FLAG_FALSE</a>, <a class="el" href="switch_8c-source.html#l00027">LITM_SHUTDOWN_FLAG_TRUE</a>, <a class="el" href="litm_8h-source.html#l00343">_litm_envelope::msg</a>, <a class="el" href="queue_8c-source.html#l00456">queue_put_head_nb()</a>, <a class="el" href="queue_8c-source.html#l00160">queue_put_nb()</a>, <a class="el" href="litm_8h-source.html#l00339">_litm_envelope::released_count</a>, <a class="el" href="litm_8h-source.html#l00337">_litm_envelope::requeued</a>, <a class="el" href="litm_8h-source.html#l00342">_litm_envelope::routes</a>, <a class="el" href="litm_8h-source.html#l00258">_litm_connection::sent</a>, and <a class="el" href="litm_8h-source.html#l00338">_litm_envelope::shutdown_flag</a>.</p>

<p>Referenced by <a class="el" href="switch_8c-source.html#l00587">switch_send()</a>, and <a class="el" href="switch_8c-source.html#l00563">switch_send_shutdown()</a>.</p>

<p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dynsection">
<p><center><img src="switch_8c_9b8ef3fb85a6655628b2e534bc7e4245_cgraph.png" border="0" usemap="#switch_8c_9b8ef3fb85a6655628b2e534bc7e4245_cgraph_map" alt=""></center>
<map name="switch_8c_9b8ef3fb85a6655628b2e534bc7e4245_cgraph_map">
<area shape="rect" href="pool_8c.html#5a3eeccda0cfcf633af7177fad20c783" title="__litm_pool_get" alt="" coords="208,5,320,32"><area shape="rect" href="pool_8c.html#1266647a6ed7c20e9c5d08f4bef09dd3" title="__litm_pool_recycle" alt="" coords="196,56,332,83"><area shape="rect" href="queue_8c.html#451122872903237ffff449a74b52608d" title="queue_put_head_nb" alt="" coords="196,107,332,133"><area shape="rect" href="queue_8c.html#ad63e2d2e97a079465ca5651b5b7c36e" title="queue_put_nb" alt="" coords="213,157,315,184"><area shape="rect" href="pool_8c.html#ad0b7166470e29cb5024efeca7d035af" title="__litm_pool_clean" alt="" coords="393,5,519,32"><area shape="rect" href="pool_8c.html#2f844d6f6d2a471a5a93c3c49c28eef2" title="__litm_pool_destroy" alt="" coords="388,56,524,83"><area shape="rect" href="queue_8c.html#145cb346a7b7660c1fdf011298d6ff5d" title="queue_put_head_safe" alt="" coords="383,107,529,133"><area shape="rect" href="queue_8c.html#24e3c9aaef201f1f66bcd8591b1e4c15" title="queue_put_safe" alt="" coords="400,157,512,184"></map>
</div>

<p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dynsection">
<p><center><img src="switch_8c_9b8ef3fb85a6655628b2e534bc7e4245_icgraph.png" border="0" usemap="#switch_8c_9b8ef3fb85a6655628b2e534bc7e4245_icgraph_map" alt=""></center>
<map name="switch_8c_9b8ef3fb85a6655628b2e534bc7e4245_icgraph_map">
<area shape="rect" href="switch_8h.html#7ff2d602f713f81e854c172e842afcad" title="switch_send" alt="" coords="227,56,320,83"><area shape="rect" href="switch_8h.html#cc4861fecbb5d0b20174fc1513539554" title="switch_send_shutdown" alt="" coords="196,107,351,133"><area shape="rect" href="litm_8h.html#bed13398c1bc31a6c81c3e50997e2f2c" title="litm_send" alt="" coords="432,5,509,32"><area shape="rect" href="litm_8h.html#f3f6e0026de45f6a16f234a28a0d003b" title="litm_send_wait" alt="" coords="417,56,524,83"><area shape="rect" href="litm_8h.html#9e932bb687ba4087d90eca7aa6583f0a" title="litm_send_shutdown" alt="" coords="401,107,540,133"></map>
</div>

</div>
</div><p>
<a class="anchor" name="99ec0a50e5e594cb656f9ea1f7d39554"></a><!-- doxytag: member="switch.c::__switch_thread_function" ref="99ec0a50e5e594cb656f9ea1f7d39554" args="(void *params)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void * __switch_thread_function           </td>
          <td>(</td>
          <td class="paramtype">void *&nbsp;</td>
          <td class="paramname"> <em>params</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
The switch thread dequeues messages from the ``input queue`` and dispatches them to the next connection <a class="el" href="structqueue.html">queue</a>. 
<p>Definition at line <a class="el" href="switch_8c-source.html#l00111">111</a> of file <a class="el" href="switch_8c-source.html">switch.c</a>.</p>

<p>References <a class="el" href="switch_8c-source.html#l00689">__switch_finalize()</a>, <a class="el" href="switch_8c-source.html#l00735">__switch_get_next_subscriber()</a>, <a class="el" href="switch_8c-source.html#l00292">__switch_handle_pending()</a>, <a class="el" href="switch_8c-source.html#l00385">__switch_try_sending_or_requeue()</a>, <a class="el" href="logger_8h-source.html#l00019">DEBUG_LOG</a>, <a class="el" href="litm_8h-source.html#l00259">_litm_connection::id</a>, <a class="el" href="litm_8h-source.html#l00305">LITM_CODE_BUSY_CONNECTIONS</a>, <a class="el" href="litm_8h-source.html#l00301">LITM_CODE_BUSY_OUTPUT_QUEUE</a>, <a class="el" href="litm_8h-source.html#l00306">LITM_CODE_ERROR_CONNECTION_NOT_ACTIVE</a>, <a class="el" href="litm_8h-source.html#l00307">LITM_CODE_ERROR_END_OF_SUBSCRIBERS_LIST</a>, <a class="el" href="litm_8h-source.html#l00289">LITM_CODE_OK</a>, <a class="el" href="switch_8c-source.html#l00028">LITM_SHUTDOWN_FLAG_FALSE</a>, <a class="el" href="switch_8c-source.html#l00027">LITM_SHUTDOWN_FLAG_TRUE</a>, <a class="el" href="litm_8c-source.html#l00320">litm_translate_code()</a>, <a class="el" href="queue_8c-source.html#l00306">queue_get_nb()</a>, <a class="el" href="queue_8c-source.html#l00130">queue_put()</a>, <a class="el" href="litm_8h-source.html#l00342">_litm_envelope::routes</a>, and <a class="el" href="litm_8h-source.html#l00338">_litm_envelope::shutdown_flag</a>.</p>

<p>Referenced by <a class="el" href="switch_8c-source.html#l00067">switch_init()</a>.</p>

<p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dynsection">
<p><center><img src="switch_8c_99ec0a50e5e594cb656f9ea1f7d39554_cgraph.png" border="0" usemap="#switch_8c_99ec0a50e5e594cb656f9ea1f7d39554_cgraph_map" alt=""></center>
<map name="switch_8c_99ec0a50e5e594cb656f9ea1f7d39554_cgraph_map">
<area shape="rect" href="switch_8c.html#149e07f06e61c0daee8f4cf38200dff2" title="__switch_finalize" alt="" coords="516,5,636,32"><area shape="rect" href="switch_8c.html#4d51cfe83ccbbb9248bbee852a1a3a65" title="__switch_get_next_subscriber" alt="" coords="223,259,417,285"><area shape="rect" href="switch_8c.html#195303a03d0b0c2a3f44951a38b2b0f6" title="__switch_handle_pending" alt="" coords="236,107,404,133"><area shape="rect" href="switch_8c.html#a915fa62ee3a445f9acac19e744005e3" title="__switch_try_sending_or_requeue" alt="" coords="468,81,684,108"><area shape="rect" href="litm_8c.html#76f700b9bb8531fd8baf8931e67c4604" title="litm_translate_code" alt="" coords="509,145,643,172"><area shape="rect" href="queue_8c.html#819eed56d043a96499116f087d928057" title="queue_get_nb" alt="" coords="269,309,371,336"><area shape="rect" href="queue_8c.html#e8939dc8316290db7846b56d38c7ff90" title="queue_put" alt="" coords="804,208,884,235"><area shape="rect" href="pool_8c.html#1266647a6ed7c20e9c5d08f4bef09dd3" title="__litm_pool_recycle" alt="" coords="776,5,912,32"><area shape="rect" href="pool_8c.html#2f844d6f6d2a471a5a93c3c49c28eef2" title="__litm_pool_destroy" alt="" coords="1008,5,1144,32"><area shape="rect" href="switch_8c.html#789e706afab00720920bef8347ac87af" title="__switch_find_match" alt="" coords="504,259,648,285"><area shape="rect" href="switch_8c.html#1025953257d7d23c8473d945dbf0c9db" title="__switch_try_sending_to_recipient" alt="" coords="735,107,953,133"><area shape="rect" href="queue_8c.html#8ef73c0a37ef99ebc486eaa88bd19cef" title="queue_put_head" alt="" coords="787,56,901,83"><area shape="rect" href="queue_8c.html#6771a5883953007fe2dc632d7c56cc98" title="queue_put_head_wait" alt="" coords="1003,107,1149,133"><area shape="rect" href="queue_8c.html#ad63e2d2e97a079465ca5651b5b7c36e" title="queue_put_nb" alt="" coords="1025,157,1127,184"><area shape="rect" href="queue_8c.html#145cb346a7b7660c1fdf011298d6ff5d" title="queue_put_head_safe" alt="" coords="1199,95,1345,121"><area shape="rect" href="queue_8c.html#24e3c9aaef201f1f66bcd8591b1e4c15" title="queue_put_safe" alt="" coords="1216,171,1328,197"><area shape="rect" href="queue_8c.html#223e84e07701aa14c2103fa27d08a101" title="__queue_get_safe" alt="" coords="512,309,640,336"></map>
</div>

<p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dynsection">
<p><center><img src="switch_8c_99ec0a50e5e594cb656f9ea1f7d39554_icgraph.png" border="0" usemap="#switch_8c_99ec0a50e5e594cb656f9ea1f7d39554_icgraph_map" alt=""></center>
<map name="switch_8c_99ec0a50e5e594cb656f9ea1f7d39554_icgraph_map">
<area shape="rect" href="switch_8h.html#cf83bfcffad6990c781b1a668ec8209e" title="switch_init" alt="" coords="221,31,304,57"><area shape="rect" href="litm_8h.html#7866d99d291588a5279844f2883fd3fa" title="litm_connect_ex" alt="" coords="353,31,468,57"><area shape="rect" href="litm_8h.html#bc852d2eb14353e36adf21c33eab03a3" title="litm_connect" alt="" coords="543,5,639,32"><area shape="rect" href="litm_8h.html#eff57ac5ec37914599624703229ba8ca" title="litm_connect_ex_wait" alt="" coords="517,56,664,83"></map>
</div>

</div>
</div><p>
<a class="anchor" name="a915fa62ee3a445f9acac19e744005e3"></a><!-- doxytag: member="switch.c::__switch_try_sending_or_requeue" ref="a915fa62ee3a445f9acac19e744005e3" args="(litm_connection *conn, litm_envelope *envlp)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="litm_8h.html#a1c70492a41df506aa1156ea7d36c4de">litm_code</a> __switch_try_sending_or_requeue           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct__litm__connection.html">litm_connection</a> *&nbsp;</td>
          <td class="paramname"> <em>conn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct__litm__envelope.html">litm_envelope</a> *&nbsp;</td>
          <td class="paramname"> <em>envlp</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Tries sending the envelope along BUT requeue if this is not possible at this juncture.<p>
The call to __switch_try_sending_to_recipient is connection safe. 
<p>Definition at line <a class="el" href="switch_8c-source.html#l00385">385</a> of file <a class="el" href="switch_8c-source.html">switch.c</a>.</p>

<p>References <a class="el" href="switch_8c-source.html#l00426">__switch_try_sending_to_recipient()</a>, <a class="el" href="litm_8h-source.html#l00340">_litm_envelope::delivery_count</a>, <a class="el" href="litm_8h-source.html#l00301">LITM_CODE_BUSY_OUTPUT_QUEUE</a>, <a class="el" href="litm_8h-source.html#l00306">LITM_CODE_ERROR_CONNECTION_NOT_ACTIVE</a>, <a class="el" href="litm_8h-source.html#l00302">LITM_CODE_ERROR_INVALID_ENVELOPE</a>, <a class="el" href="litm_8h-source.html#l00289">LITM_CODE_OK</a>, <a class="el" href="queue_8c-source.html#l00487">queue_put_head()</a>, <a class="el" href="litm_8h-source.html#l00337">_litm_envelope::requeued</a>, and <a class="el" href="litm_8h-source.html#l00342">_litm_envelope::routes</a>.</p>

<p>Referenced by <a class="el" href="switch_8c-source.html#l00292">__switch_handle_pending()</a>, and <a class="el" href="switch_8c-source.html#l00111">__switch_thread_function()</a>.</p>

<p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dynsection">
<p><center><img src="switch_8c_a915fa62ee3a445f9acac19e744005e3_cgraph.png" border="0" usemap="#switch_8c_a915fa62ee3a445f9acac19e744005e3_cgraph_map" alt=""></center>
<map name="switch_8c_a915fa62ee3a445f9acac19e744005e3_cgraph_map">
<area shape="rect" href="switch_8c.html#1025953257d7d23c8473d945dbf0c9db" title="__switch_try_sending_to_recipient" alt="" coords="273,56,492,83"><area shape="rect" href="queue_8c.html#8ef73c0a37ef99ebc486eaa88bd19cef" title="queue_put_head" alt="" coords="325,107,440,133"><area shape="rect" href="queue_8c.html#6771a5883953007fe2dc632d7c56cc98" title="queue_put_head_wait" alt="" coords="541,56,688,83"><area shape="rect" href="queue_8c.html#ad63e2d2e97a079465ca5651b5b7c36e" title="queue_put_nb" alt="" coords="564,5,665,32"><area shape="rect" href="queue_8c.html#145cb346a7b7660c1fdf011298d6ff5d" title="queue_put_head_safe" alt="" coords="737,81,884,108"><area shape="rect" href="queue_8c.html#24e3c9aaef201f1f66bcd8591b1e4c15" title="queue_put_safe" alt="" coords="755,5,867,32"></map>
</div>

<p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dynsection">
<p><center><img src="switch_8c_a915fa62ee3a445f9acac19e744005e3_icgraph.png" border="0" usemap="#switch_8c_a915fa62ee3a445f9acac19e744005e3_icgraph_map" alt=""></center>
<map name="switch_8c_a915fa62ee3a445f9acac19e744005e3_icgraph_map">
<area shape="rect" href="switch_8c.html#195303a03d0b0c2a3f44951a38b2b0f6" title="__switch_handle_pending" alt="" coords="273,5,441,32"><area shape="rect" href="switch_8c.html#99ec0a50e5e594cb656f9ea1f7d39554" title="__switch_thread_function" alt="" coords="491,31,659,57"><area shape="rect" href="switch_8h.html#cf83bfcffad6990c781b1a668ec8209e" title="switch_init" alt="" coords="707,31,789,57"><area shape="rect" href="litm_8h.html#7866d99d291588a5279844f2883fd3fa" title="litm_connect_ex" alt="" coords="839,31,953,57"><area shape="rect" href="litm_8h.html#bc852d2eb14353e36adf21c33eab03a3" title="litm_connect" alt="" coords="1028,5,1124,32"><area shape="rect" href="litm_8h.html#eff57ac5ec37914599624703229ba8ca" title="litm_connect_ex_wait" alt="" coords="1003,56,1149,83"></map>
</div>

</div>
</div><p>
<a class="anchor" name="1025953257d7d23c8473d945dbf0c9db"></a><!-- doxytag: member="switch.c::__switch_try_sending_to_recipient" ref="1025953257d7d23c8473d945dbf0c9db" args="(litm_connection *recipient, litm_envelope *env)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="litm_8h.html#a1c70492a41df506aa1156ea7d36c4de">litm_code</a> __switch_try_sending_to_recipient           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct__litm__connection.html">litm_connection</a> *&nbsp;</td>
          <td class="paramname"> <em>conn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct__litm__envelope.html">litm_envelope</a> *&nbsp;</td>
          <td class="paramname"> <em>env</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Try sending the message to the recipient.<p>
This function does not block waiting for the recipient. This function should only be called by ''__switch_try_sending_or_requeue''. 
<p>Definition at line <a class="el" href="switch_8c-source.html#l00426">426</a> of file <a class="el" href="switch_8c-source.html">switch.c</a>.</p>

<p>References <a class="el" href="logger_8h-source.html#l00019">DEBUG_LOG</a>, <a class="el" href="litm_8h-source.html#l00261">_litm_connection::input_queue</a>, <a class="el" href="litm_8h-source.html#l00301">LITM_CODE_BUSY_OUTPUT_QUEUE</a>, <a class="el" href="litm_8h-source.html#l00294">LITM_CODE_ERROR_BAD_CONNECTION</a>, <a class="el" href="litm_8h-source.html#l00306">LITM_CODE_ERROR_CONNECTION_NOT_ACTIVE</a>, <a class="el" href="litm_8h-source.html#l00302">LITM_CODE_ERROR_INVALID_ENVELOPE</a>, <a class="el" href="litm_8h-source.html#l00300">LITM_CODE_ERROR_OUTPUT_QUEUING</a>, <a class="el" href="litm_8h-source.html#l00289">LITM_CODE_OK</a>, <a class="el" href="switch_8c-source.html#l00028">LITM_SHUTDOWN_FLAG_FALSE</a>, <a class="el" href="switch_8c-source.html#l00027">LITM_SHUTDOWN_FLAG_TRUE</a>, <a class="el" href="queue_8c-source.html#l00517">queue_put_head_wait()</a>, <a class="el" href="queue_8c-source.html#l00160">queue_put_nb()</a>, <a class="el" href="litm_8h-source.html#l00342">_litm_envelope::routes</a>, and <a class="el" href="litm_8h-source.html#l00338">_litm_envelope::shutdown_flag</a>.</p>

<p>Referenced by <a class="el" href="switch_8c-source.html#l00385">__switch_try_sending_or_requeue()</a>.</p>

<p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dynsection">
<p><center><img src="switch_8c_1025953257d7d23c8473d945dbf0c9db_cgraph.png" border="0" usemap="#switch_8c_1025953257d7d23c8473d945dbf0c9db_cgraph_map" alt=""></center>
<map name="switch_8c_1025953257d7d23c8473d945dbf0c9db_cgraph_map">
<area shape="rect" href="queue_8c.html#6771a5883953007fe2dc632d7c56cc98" title="queue_put_head_wait" alt="" coords="275,5,421,32"><area shape="rect" href="queue_8c.html#ad63e2d2e97a079465ca5651b5b7c36e" title="queue_put_nb" alt="" coords="297,56,399,83"><area shape="rect" href="queue_8c.html#145cb346a7b7660c1fdf011298d6ff5d" title="queue_put_head_safe" alt="" coords="471,5,617,32"><area shape="rect" href="queue_8c.html#24e3c9aaef201f1f66bcd8591b1e4c15" title="queue_put_safe" alt="" coords="488,56,600,83"></map>
</div>

<p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dynsection">
<p><center><img src="switch_8c_1025953257d7d23c8473d945dbf0c9db_icgraph.png" border="0" usemap="#switch_8c_1025953257d7d23c8473d945dbf0c9db_icgraph_map" alt=""></center>
<map name="switch_8c_1025953257d7d23c8473d945dbf0c9db_icgraph_map">
<area shape="rect" href="switch_8c.html#a915fa62ee3a445f9acac19e744005e3" title="__switch_try_sending_or_requeue" alt="" coords="276,31,492,57"><area shape="rect" href="switch_8c.html#195303a03d0b0c2a3f44951a38b2b0f6" title="__switch_handle_pending" alt="" coords="543,5,711,32"><area shape="rect" href="switch_8c.html#99ec0a50e5e594cb656f9ea1f7d39554" title="__switch_thread_function" alt="" coords="760,31,928,57"><area shape="rect" href="switch_8h.html#cf83bfcffad6990c781b1a668ec8209e" title="switch_init" alt="" coords="976,31,1059,57"><area shape="rect" href="litm_8h.html#7866d99d291588a5279844f2883fd3fa" title="litm_connect_ex" alt="" coords="1108,31,1223,57"><area shape="rect" href="litm_8h.html#bc852d2eb14353e36adf21c33eab03a3" title="litm_connect" alt="" coords="1297,5,1393,32"><area shape="rect" href="litm_8h.html#eff57ac5ec37914599624703229ba8ca" title="litm_connect_ex_wait" alt="" coords="1272,56,1419,83"></map>
</div>

</div>
</div><p>
<a class="anchor" name="21156cec60e58e66f5d409c0cfbcfb12"></a><!-- doxytag: member="switch.c::__switch_wait_shutdown" ref="21156cec60e58e66f5d409c0cfbcfb12" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void __switch_wait_shutdown           </td>
          <td>(</td>
          <td class="paramtype">void&nbsp;</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Wait for shutdown<p>
Once a litm_send_shutdowm is used, this function should be called to neatly shutdown the process. 
<p>Definition at line <a class="el" href="switch_8c-source.html#l00099">99</a> of file <a class="el" href="switch_8c-source.html">switch.c</a>.</p>

<p>References <a class="el" href="switch_8c-source.html#l00034">_switchThread</a>.</p>

<p>Referenced by <a class="el" href="litm_8c-source.html#l00352">litm_wait_shutdown()</a>.</p>

<p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dynsection">
<p><center><img src="switch_8c_21156cec60e58e66f5d409c0cfbcfb12_icgraph.png" border="0" usemap="#switch_8c_21156cec60e58e66f5d409c0cfbcfb12_icgraph_map" alt=""></center>
<map name="switch_8c_21156cec60e58e66f5d409c0cfbcfb12_icgraph_map">
<area shape="rect" href="litm_8h.html#4af596df43cd495373587efed2dbb9ce" title="litm_wait_shutdown" alt="" coords="220,5,353,32"></map>
</div>

</div>
</div><p>
<a class="anchor" name="c5408c5b37244e5d0fe17f55f1c3f89e"></a><!-- doxytag: member="switch.c::switch_add_subscriber" ref="c5408c5b37244e5d0fe17f55f1c3f89e" args="(litm_connection *conn, litm_bus bus_id)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="litm_8h.html#a1c70492a41df506aa1156ea7d36c4de">litm_code</a> switch_add_subscriber           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct__litm__connection.html">litm_connection</a> *&nbsp;</td>
          <td class="paramname"> <em>conn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="litm_8h.html#e7fcc1b5cd037f318d4fe40a2f9d30d3">litm_bus</a>&nbsp;</td>
          <td class="paramname"> <em>bus_id</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>Definition at line <a class="el" href="switch_8c-source.html#l00481">481</a> of file <a class="el" href="switch_8c-source.html">switch.c</a>.</p>

<p>References <a class="el" href="connection_8c-source.html#l00239">_litm_connections_trylock()</a>, <a class="el" href="connection_8c-source.html#l00246">_litm_connections_unlock()</a>, <a class="el" href="switch_8c-source.html#l00039">_subscribers_mutex</a>, <a class="el" href="litm_8h-source.html#l00201">LITM_BUSSES_MAX</a>, <a class="el" href="litm_8h-source.html#l00291">LITM_CODE_BUSY</a>, <a class="el" href="litm_8h-source.html#l00294">LITM_CODE_ERROR_BAD_CONNECTION</a>, <a class="el" href="litm_8h-source.html#l00304">LITM_CODE_ERROR_BUS_FULL</a>, <a class="el" href="litm_8h-source.html#l00296">LITM_CODE_ERROR_INVALID_BUS</a>, <a class="el" href="litm_8h-source.html#l00289">LITM_CODE_OK</a>, and <a class="el" href="litm_8h-source.html#l00200">LITM_CONNECTION_MAX</a>.</p>

<p>Referenced by <a class="el" href="litm_8c-source.html#l00117">litm_subscribe()</a>, and <a class="el" href="litm_8c-source.html#l00124">litm_subscribe_wait()</a>.</p>

<p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dynsection">
<p><center><img src="switch_8c_c5408c5b37244e5d0fe17f55f1c3f89e_cgraph.png" border="0" usemap="#switch_8c_c5408c5b37244e5d0fe17f55f1c3f89e_cgraph_map" alt=""></center>
<map name="switch_8c_c5408c5b37244e5d0fe17f55f1c3f89e_cgraph_map">
<area shape="rect" href="connection_8c.html#6b2986abb5453019ea29678d1d75383f" title="_litm_connections_trylock" alt="" coords="209,5,380,32"><area shape="rect" href="connection_8c.html#c75b4b0413d3523574bda13549715447" title="_litm_connections_unlock" alt="" coords="209,56,380,83"></map>
</div>

<p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dynsection">
<p><center><img src="switch_8c_c5408c5b37244e5d0fe17f55f1c3f89e_icgraph.png" border="0" usemap="#switch_8c_c5408c5b37244e5d0fe17f55f1c3f89e_icgraph_map" alt=""></center>
<map name="switch_8c_c5408c5b37244e5d0fe17f55f1c3f89e_icgraph_map">
<area shape="rect" href="litm_8h.html#1c8191e4aca778b346954933c7bdf3ff" title="litm_subscribe" alt="" coords="224,5,328,32"><area shape="rect" href="litm_8h.html#6d62a2a46ae6be134168a00b386afe0d" title="litm_subscribe_wait" alt="" coords="208,56,344,83"></map>
</div>

</div>
</div><p>
<a class="anchor" name="cf83bfcffad6990c781b1a668ec8209e"></a><!-- doxytag: member="switch.c::switch_init" ref="cf83bfcffad6990c781b1a668ec8209e" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int switch_init           </td>
          <td>(</td>
          <td class="paramtype">void&nbsp;</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>Definition at line <a class="el" href="switch_8c-source.html#l00067">67</a> of file <a class="el" href="switch_8c-source.html">switch.c</a>.</p>

<p>References <a class="el" href="switch_8c-source.html#l00084">__switch_init_tables()</a>, <a class="el" href="switch_8c-source.html#l00111">__switch_thread_function()</a>, <a class="el" href="switch_8c-source.html#l00034">_switchThread</a>, <a class="el" href="switch_8c-source.html#l00035">_switchThread_status</a>, and <a class="el" href="queue_8c-source.html#l00035">queue_create()</a>.</p>

<p>Referenced by <a class="el" href="litm_8c-source.html#l00061">litm_connect_ex()</a>.</p>

<p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dynsection">
<p><center><img src="switch_8c_cf83bfcffad6990c781b1a668ec8209e_cgraph.png" border="0" usemap="#switch_8c_cf83bfcffad6990c781b1a668ec8209e_cgraph_map" alt=""></center>
<map name="switch_8c_cf83bfcffad6990c781b1a668ec8209e_cgraph_map">
<area shape="rect" href="switch_8c.html#e4d3d02052899f64d09070f18f75c29a" title="__switch_init_tables" alt="" coords="151,107,289,133"><area shape="rect" href="switch_8c.html#99ec0a50e5e594cb656f9ea1f7d39554" title="__switch_thread_function" alt="" coords="136,157,304,184"><area shape="rect" href="queue_8c.html#fb5475fae1028dd41cf622ef2dc84036" title="queue_create" alt="" coords="171,208,269,235"><area shape="rect" href="switch_8c.html#149e07f06e61c0daee8f4cf38200dff2" title="__switch_finalize" alt="" coords="647,5,767,32"><area shape="rect" href="switch_8c.html#4d51cfe83ccbbb9248bbee852a1a3a65" title="__switch_get_next_subscriber" alt="" coords="353,259,548,285"><area shape="rect" href="switch_8c.html#195303a03d0b0c2a3f44951a38b2b0f6" title="__switch_handle_pending" alt="" coords="367,107,535,133"><area shape="rect" href="switch_8c.html#a915fa62ee3a445f9acac19e744005e3" title="__switch_try_sending_or_requeue" alt="" coords="599,81,815,108"><area shape="rect" href="litm_8c.html#76f700b9bb8531fd8baf8931e67c4604" title="litm_translate_code" alt="" coords="640,145,773,172"><area shape="rect" href="queue_8c.html#819eed56d043a96499116f087d928057" title="queue_get_nb" alt="" coords="400,309,501,336"><area shape="rect" href="queue_8c.html#e8939dc8316290db7846b56d38c7ff90" title="queue_put" alt="" coords="935,208,1015,235"><area shape="rect" href="pool_8c.html#1266647a6ed7c20e9c5d08f4bef09dd3" title="__litm_pool_recycle" alt="" coords="907,5,1043,32"><area shape="rect" href="pool_8c.html#2f844d6f6d2a471a5a93c3c49c28eef2" title="__litm_pool_destroy" alt="" coords="1139,5,1275,32"><area shape="rect" href="switch_8c.html#789e706afab00720920bef8347ac87af" title="__switch_find_match" alt="" coords="635,259,779,285"><area shape="rect" href="switch_8c.html#1025953257d7d23c8473d945dbf0c9db" title="__switch_try_sending_to_recipient" alt="" coords="865,107,1084,133"><area shape="rect" href="queue_8c.html#8ef73c0a37ef99ebc486eaa88bd19cef" title="queue_put_head" alt="" coords="917,56,1032,83"><area shape="rect" href="queue_8c.html#6771a5883953007fe2dc632d7c56cc98" title="queue_put_head_wait" alt="" coords="1133,107,1280,133"><area shape="rect" href="queue_8c.html#ad63e2d2e97a079465ca5651b5b7c36e" title="queue_put_nb" alt="" coords="1156,157,1257,184"><area shape="rect" href="queue_8c.html#145cb346a7b7660c1fdf011298d6ff5d" title="queue_put_head_safe" alt="" coords="1329,95,1476,121"><area shape="rect" href="queue_8c.html#24e3c9aaef201f1f66bcd8591b1e4c15" title="queue_put_safe" alt="" coords="1347,171,1459,197"><area shape="rect" href="queue_8c.html#223e84e07701aa14c2103fa27d08a101" title="__queue_get_safe" alt="" coords="643,309,771,336"></map>
</div>

<p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dynsection">
<p><center><img src="switch_8c_cf83bfcffad6990c781b1a668ec8209e_icgraph.png" border="0" usemap="#switch_8c_cf83bfcffad6990c781b1a668ec8209e_icgraph_map" alt=""></center>
<map name="switch_8c_cf83bfcffad6990c781b1a668ec8209e_icgraph_map">
<area shape="rect" href="litm_8h.html#7866d99d291588a5279844f2883fd3fa" title="litm_connect_ex" alt="" coords="137,31,252,57"><area shape="rect" href="litm_8h.html#bc852d2eb14353e36adf21c33eab03a3" title="litm_connect" alt="" coords="327,5,423,32"><area shape="rect" href="litm_8h.html#eff57ac5ec37914599624703229ba8ca" title="litm_connect_ex_wait" alt="" coords="301,56,448,83"></map>
</div>

</div>
</div><p>
<a class="anchor" name="2bab91639e612d51d0d7d8a3a64d0ace"></a><!-- doxytag: member="switch.c::switch_release" ref="2bab91639e612d51d0d7d8a3a64d0ace" args="(litm_connection *conn, litm_envelope *envlp)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="litm_8h.html#a1c70492a41df506aa1156ea7d36c4de">litm_code</a> switch_release           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct__litm__connection.html">litm_connection</a> *&nbsp;</td>
          <td class="paramname"> <em>conn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct__litm__envelope.html">litm_envelope</a> *&nbsp;</td>
          <td class="paramname"> <em>envlp</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
A client has finished processing a message: send it through through the ``input_queue`` and if all intended recipients have processed it already, it will be finalized. 
<p>Definition at line <a class="el" href="switch_8c-source.html#l00343">343</a> of file <a class="el" href="switch_8c-source.html">switch.c</a>.</p>

<p>References <a class="el" href="switch_8c-source.html#l00689">__switch_finalize()</a>, <a class="el" href="logger_8h-source.html#l00019">DEBUG_LOG</a>, <a class="el" href="litm_8h-source.html#l00294">LITM_CODE_ERROR_BAD_CONNECTION</a>, <a class="el" href="litm_8h-source.html#l00302">LITM_CODE_ERROR_INVALID_ENVELOPE</a>, <a class="el" href="litm_8h-source.html#l00292">LITM_CODE_ERROR_MALLOC</a>, <a class="el" href="litm_8h-source.html#l00289">LITM_CODE_OK</a>, <a class="el" href="queue_8c-source.html#l00130">queue_put()</a>, <a class="el" href="queue_8c-source.html#l00438">queue_signal()</a>, <a class="el" href="litm_8h-source.html#l00257">_litm_connection::released</a>, <a class="el" href="litm_8h-source.html#l00339">_litm_envelope::released_count</a>, and <a class="el" href="litm_8h-source.html#l00342">_litm_envelope::routes</a>.</p>

<p>Referenced by <a class="el" href="litm_8c-source.html#l00303">litm_release()</a>.</p>

<p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dynsection">
<p><center><img src="switch_8c_2bab91639e612d51d0d7d8a3a64d0ace_cgraph.png" border="0" usemap="#switch_8c_2bab91639e612d51d0d7d8a3a64d0ace_cgraph_map" alt=""></center>
<map name="switch_8c_2bab91639e612d51d0d7d8a3a64d0ace_cgraph_map">
<area shape="rect" href="switch_8c.html#149e07f06e61c0daee8f4cf38200dff2" title="__switch_finalize" alt="" coords="163,5,283,32"><area shape="rect" href="queue_8c.html#e8939dc8316290db7846b56d38c7ff90" title="queue_put" alt="" coords="183,56,263,83"><area shape="rect" href="queue_8c.html#a1c32f105f2a17f2255cbe6dfaf66f78" title="queue_signal" alt="" coords="175,107,271,133"><area shape="rect" href="pool_8c.html#1266647a6ed7c20e9c5d08f4bef09dd3" title="__litm_pool_recycle" alt="" coords="331,5,467,32"><area shape="rect" href="pool_8c.html#2f844d6f6d2a471a5a93c3c49c28eef2" title="__litm_pool_destroy" alt="" coords="516,5,652,32"><area shape="rect" href="queue_8c.html#24e3c9aaef201f1f66bcd8591b1e4c15" title="queue_put_safe" alt="" coords="343,56,455,83"></map>
</div>

<p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dynsection">
<p><center><img src="switch_8c_2bab91639e612d51d0d7d8a3a64d0ace_icgraph.png" border="0" usemap="#switch_8c_2bab91639e612d51d0d7d8a3a64d0ace_icgraph_map" alt=""></center>
<map name="switch_8c_2bab91639e612d51d0d7d8a3a64d0ace_icgraph_map">
<area shape="rect" href="litm_8h.html#21def412c9b064fc929e0822f28d2a2a" title="litm_release" alt="" coords="164,5,255,32"></map>
</div>

</div>
</div><p>
<a class="anchor" name="a12d12ec55e370e7b2d960a67ab19078"></a><!-- doxytag: member="switch.c::switch_remove_subscriber" ref="a12d12ec55e370e7b2d960a67ab19078" args="(litm_connection *conn, litm_bus bus_id)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="litm_8h.html#a1c70492a41df506aa1156ea7d36c4de">litm_code</a> switch_remove_subscriber           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct__litm__connection.html">litm_connection</a> *&nbsp;</td>
          <td class="paramname"> <em>conn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="litm_8h.html#e7fcc1b5cd037f318d4fe40a2f9d30d3">litm_bus</a>&nbsp;</td>
          <td class="paramname"> <em>bus_id</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>Definition at line <a class="el" href="switch_8c-source.html#l00520">520</a> of file <a class="el" href="switch_8c-source.html">switch.c</a>.</p>

<p>References <a class="el" href="connection_8c-source.html#l00239">_litm_connections_trylock()</a>, <a class="el" href="connection_8c-source.html#l00246">_litm_connections_unlock()</a>, <a class="el" href="switch_8c-source.html#l00039">_subscribers_mutex</a>, <a class="el" href="litm_8h-source.html#l00201">LITM_BUSSES_MAX</a>, <a class="el" href="litm_8h-source.html#l00291">LITM_CODE_BUSY</a>, <a class="el" href="litm_8h-source.html#l00294">LITM_CODE_ERROR_BAD_CONNECTION</a>, <a class="el" href="litm_8h-source.html#l00296">LITM_CODE_ERROR_INVALID_BUS</a>, <a class="el" href="litm_8h-source.html#l00303">LITM_CODE_ERROR_SUBSCRIPTION_NOT_FOUND</a>, <a class="el" href="litm_8h-source.html#l00289">LITM_CODE_OK</a>, and <a class="el" href="litm_8h-source.html#l00200">LITM_CONNECTION_MAX</a>.</p>

<p>Referenced by <a class="el" href="litm_8c-source.html#l00160">litm_unsubscribe()</a>.</p>

<p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dynsection">
<p><center><img src="switch_8c_a12d12ec55e370e7b2d960a67ab19078_cgraph.png" border="0" usemap="#switch_8c_a12d12ec55e370e7b2d960a67ab19078_cgraph_map" alt=""></center>
<map name="switch_8c_a12d12ec55e370e7b2d960a67ab19078_cgraph_map">
<area shape="rect" href="connection_8c.html#6b2986abb5453019ea29678d1d75383f" title="_litm_connections_trylock" alt="" coords="231,5,401,32"><area shape="rect" href="connection_8c.html#c75b4b0413d3523574bda13549715447" title="_litm_connections_unlock" alt="" coords="231,56,401,83"></map>
</div>

<p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dynsection">
<p><center><img src="switch_8c_a12d12ec55e370e7b2d960a67ab19078_icgraph.png" border="0" usemap="#switch_8c_a12d12ec55e370e7b2d960a67ab19078_icgraph_map" alt=""></center>
<map name="switch_8c_a12d12ec55e370e7b2d960a67ab19078_icgraph_map">
<area shape="rect" href="litm_8h.html#50225024a2292b63a5eb95cca00f2545" title="litm_unsubscribe" alt="" coords="229,5,349,32"></map>
</div>

</div>
</div><p>
<a class="anchor" name="7ff2d602f713f81e854c172e842afcad"></a><!-- doxytag: member="switch.c::switch_send" ref="7ff2d602f713f81e854c172e842afcad" args="(litm_connection *conn, litm_bus bus_id, void *msg, void(*cleaner)(void *msg))" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="litm_8h.html#a1c70492a41df506aa1156ea7d36c4de">litm_code</a> switch_send           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct__litm__connection.html">litm_connection</a> *&nbsp;</td>
          <td class="paramname"> <em>conn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="litm_8h.html#e7fcc1b5cd037f318d4fe40a2f9d30d3">litm_bus</a>&nbsp;</td>
          <td class="paramname"> <em>bus_id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&nbsp;</td>
          <td class="paramname"> <em>msg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void(*)(void *msg)&nbsp;</td>
          <td class="paramname"> <em>cleaner</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
This function just queues up the message in the switch's input_queue without actually sending it to recipients.<p>
This function blocks whilst accessing the switch's ``input_queue`` but no deadlock scenario is possible since the switch's thread does not block whilst dequeuing. 
<p>Definition at line <a class="el" href="switch_8c-source.html#l00587">587</a> of file <a class="el" href="switch_8c-source.html">switch.c</a>.</p>

<p>References <a class="el" href="switch_8c-source.html#l00603">__switch_safe_send()</a>, <a class="el" href="litm_8h-source.html#l00201">LITM_BUSSES_MAX</a>, <a class="el" href="litm_8h-source.html#l00294">LITM_CODE_ERROR_BAD_CONNECTION</a>, <a class="el" href="litm_8h-source.html#l00296">LITM_CODE_ERROR_INVALID_BUS</a>, and <a class="el" href="switch_8c-source.html#l00028">LITM_SHUTDOWN_FLAG_FALSE</a>.</p>

<p>Referenced by <a class="el" href="litm_8c-source.html#l00166">litm_send()</a>, and <a class="el" href="litm_8c-source.html#l00176">litm_send_wait()</a>.</p>

<p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dynsection">
<p><center><img src="switch_8c_7ff2d602f713f81e854c172e842afcad_cgraph.png" border="0" usemap="#switch_8c_7ff2d602f713f81e854c172e842afcad_cgraph_map" alt=""></center>
<map name="switch_8c_7ff2d602f713f81e854c172e842afcad_cgraph_map">
<area shape="rect" href="switch_8c.html#9b8ef3fb85a6655628b2e534bc7e4245" title="__switch_safe_send" alt="" coords="148,81,287,108"><area shape="rect" href="pool_8c.html#5a3eeccda0cfcf633af7177fad20c783" title="__litm_pool_get" alt="" coords="349,5,461,32"><area shape="rect" href="pool_8c.html#1266647a6ed7c20e9c5d08f4bef09dd3" title="__litm_pool_recycle" alt="" coords="337,56,473,83"><area shape="rect" href="queue_8c.html#451122872903237ffff449a74b52608d" title="queue_put_head_nb" alt="" coords="337,107,473,133"><area shape="rect" href="queue_8c.html#ad63e2d2e97a079465ca5651b5b7c36e" title="queue_put_nb" alt="" coords="355,157,456,184"><area shape="rect" href="pool_8c.html#ad0b7166470e29cb5024efeca7d035af" title="__litm_pool_clean" alt="" coords="535,5,660,32"><area shape="rect" href="pool_8c.html#2f844d6f6d2a471a5a93c3c49c28eef2" title="__litm_pool_destroy" alt="" coords="529,56,665,83"><area shape="rect" href="queue_8c.html#145cb346a7b7660c1fdf011298d6ff5d" title="queue_put_head_safe" alt="" coords="524,107,671,133"><area shape="rect" href="queue_8c.html#24e3c9aaef201f1f66bcd8591b1e4c15" title="queue_put_safe" alt="" coords="541,157,653,184"></map>
</div>

<p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dynsection">
<p><center><img src="switch_8c_7ff2d602f713f81e854c172e842afcad_icgraph.png" border="0" usemap="#switch_8c_7ff2d602f713f81e854c172e842afcad_icgraph_map" alt=""></center>
<map name="switch_8c_7ff2d602f713f81e854c172e842afcad_icgraph_map">
<area shape="rect" href="litm_8h.html#bed13398c1bc31a6c81c3e50997e2f2c" title="litm_send" alt="" coords="163,5,240,32"><area shape="rect" href="litm_8h.html#f3f6e0026de45f6a16f234a28a0d003b" title="litm_send_wait" alt="" coords="148,56,255,83"></map>
</div>

</div>
</div><p>
<a class="anchor" name="cc4861fecbb5d0b20174fc1513539554"></a><!-- doxytag: member="switch.c::switch_send_shutdown" ref="cc4861fecbb5d0b20174fc1513539554" args="(litm_connection *conn, litm_bus bus_id, void *msg, void(*cleaner)(void *msg))" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="litm_8h.html#a1c70492a41df506aa1156ea7d36c4de">litm_code</a> switch_send_shutdown           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct__litm__connection.html">litm_connection</a> *&nbsp;</td>
          <td class="paramname"> <em>conn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="litm_8h.html#e7fcc1b5cd037f318d4fe40a2f9d30d3">litm_bus</a>&nbsp;</td>
          <td class="paramname"> <em>bus_id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&nbsp;</td>
          <td class="paramname"> <em>msg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void(*)(void *msg)&nbsp;</td>
          <td class="paramname"> <em>cleaner</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
<dl class="see" compact><dt><b>See also:</b></dt><dd><a class="el" href="switch_8h.html#7ff2d602f713f81e854c172e842afcad">switch_send</a> </dd></dl>

<p>Definition at line <a class="el" href="switch_8c-source.html#l00563">563</a> of file <a class="el" href="switch_8c-source.html">switch.c</a>.</p>

<p>References <a class="el" href="switch_8c-source.html#l00603">__switch_safe_send()</a>, <a class="el" href="litm_8h-source.html#l00201">LITM_BUSSES_MAX</a>, <a class="el" href="litm_8h-source.html#l00294">LITM_CODE_ERROR_BAD_CONNECTION</a>, <a class="el" href="litm_8h-source.html#l00296">LITM_CODE_ERROR_INVALID_BUS</a>, and <a class="el" href="switch_8c-source.html#l00027">LITM_SHUTDOWN_FLAG_TRUE</a>.</p>

<p>Referenced by <a class="el" href="litm_8c-source.html#l00217">litm_send_shutdown()</a>.</p>

<p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dynsection">
<p><center><img src="switch_8c_cc4861fecbb5d0b20174fc1513539554_cgraph.png" border="0" usemap="#switch_8c_cc4861fecbb5d0b20174fc1513539554_cgraph_map" alt=""></center>
<map name="switch_8c_cc4861fecbb5d0b20174fc1513539554_cgraph_map">
<area shape="rect" href="switch_8c.html#9b8ef3fb85a6655628b2e534bc7e4245" title="__switch_safe_send" alt="" coords="212,81,351,108"><area shape="rect" href="pool_8c.html#5a3eeccda0cfcf633af7177fad20c783" title="__litm_pool_get" alt="" coords="413,5,525,32"><area shape="rect" href="pool_8c.html#1266647a6ed7c20e9c5d08f4bef09dd3" title="__litm_pool_recycle" alt="" coords="401,56,537,83"><area shape="rect" href="queue_8c.html#451122872903237ffff449a74b52608d" title="queue_put_head_nb" alt="" coords="401,107,537,133"><area shape="rect" href="queue_8c.html#ad63e2d2e97a079465ca5651b5b7c36e" title="queue_put_nb" alt="" coords="419,157,520,184"><area shape="rect" href="pool_8c.html#ad0b7166470e29cb5024efeca7d035af" title="__litm_pool_clean" alt="" coords="599,5,724,32"><area shape="rect" href="pool_8c.html#2f844d6f6d2a471a5a93c3c49c28eef2" title="__litm_pool_destroy" alt="" coords="593,56,729,83"><area shape="rect" href="queue_8c.html#145cb346a7b7660c1fdf011298d6ff5d" title="queue_put_head_safe" alt="" coords="588,107,735,133"><area shape="rect" href="queue_8c.html#24e3c9aaef201f1f66bcd8591b1e4c15" title="queue_put_safe" alt="" coords="605,157,717,184"></map>
</div>

<p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dynsection">
<p><center><img src="switch_8c_cc4861fecbb5d0b20174fc1513539554_icgraph.png" border="0" usemap="#switch_8c_cc4861fecbb5d0b20174fc1513539554_icgraph_map" alt=""></center>
<map name="switch_8c_cc4861fecbb5d0b20174fc1513539554_icgraph_map">
<area shape="rect" href="litm_8h.html#9e932bb687ba4087d90eca7aa6583f0a" title="litm_send_shutdown" alt="" coords="212,5,351,32"></map>
</div>

</div>
</div><p>
<hr><h2>Variable Documentation</h2>
<a class="anchor" name="21322c5d86d64dd361bd78848c7355d6"></a><!-- doxytag: member="switch.c::_subscribers" ref="21322c5d86d64dd361bd78848c7355d6" args="[LITM_BUSSES_MAX][LITM_CONNECTION_MAX+1]" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="struct__litm__connection.html">litm_connection</a>* <a class="el" href="switch_8c.html#21322c5d86d64dd361bd78848c7355d6">_subscribers</a>[LITM_BUSSES_MAX][LITM_CONNECTION_MAX+1]          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>Definition at line <a class="el" href="switch_8c-source.html#l00040">40</a> of file <a class="el" href="switch_8c-source.html">switch.c</a>.</p>

</div>
</div><p>
<a class="anchor" name="66b222465cf692f5b9da017fa259dda1"></a><!-- doxytag: member="switch.c::_subscribers_mutex" ref="66b222465cf692f5b9da017fa259dda1" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pthread_mutex_t <a class="el" href="switch_8c.html#66b222465cf692f5b9da017fa259dda1">_subscribers_mutex</a> = PTHREAD_MUTEX_INITIALIZER          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>Definition at line <a class="el" href="switch_8c-source.html#l00039">39</a> of file <a class="el" href="switch_8c-source.html">switch.c</a>.</p>

<p>Referenced by <a class="el" href="switch_8c-source.html#l00481">switch_add_subscriber()</a>, and <a class="el" href="switch_8c-source.html#l00520">switch_remove_subscriber()</a>.</p>

</div>
</div><p>
<a class="anchor" name="45d2c8f54ca279893a75408e9164be6a"></a><!-- doxytag: member="switch.c::_switch_queue" ref="45d2c8f54ca279893a75408e9164be6a" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structqueue.html">queue</a>* <a class="el" href="switch_8c.html#45d2c8f54ca279893a75408e9164be6a">_switch_queue</a>          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>Definition at line <a class="el" href="switch_8c-source.html#l00031">31</a> of file <a class="el" href="switch_8c-source.html">switch.c</a>.</p>

</div>
</div><p>
<a class="anchor" name="cb3ec39b5454e93fd98267ce8a0d7bab"></a><!-- doxytag: member="switch.c::_switchThread" ref="cb3ec39b5454e93fd98267ce8a0d7bab" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pthread_t <a class="el" href="switch_8c.html#cb3ec39b5454e93fd98267ce8a0d7bab">_switchThread</a>          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>Definition at line <a class="el" href="switch_8c-source.html#l00034">34</a> of file <a class="el" href="switch_8c-source.html">switch.c</a>.</p>

<p>Referenced by <a class="el" href="switch_8c-source.html#l00099">__switch_wait_shutdown()</a>, and <a class="el" href="switch_8c-source.html#l00067">switch_init()</a>.</p>

</div>
</div><p>
<a class="anchor" name="d8504e0696f737980aafecd01c559839"></a><!-- doxytag: member="switch.c::_switchThread_status" ref="d8504e0696f737980aafecd01c559839" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int <a class="el" href="switch_8c.html#d8504e0696f737980aafecd01c559839">_switchThread_status</a> = 0          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>Definition at line <a class="el" href="switch_8c-source.html#l00035">35</a> of file <a class="el" href="switch_8c-source.html">switch.c</a>.</p>

<p>Referenced by <a class="el" href="switch_8c-source.html#l00067">switch_init()</a>.</p>

</div>
</div><p>
</div>
<hr size="1"><address style="text-align: right;"><small>Generated on Fri May 15 11:43:07 2009 for LITM by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.5.8 </small></address>
</body>
</html>
