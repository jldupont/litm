<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
<title>LITM: Welcome to the documentation for the library LITM -- 0.5</title>
<link href="tabs.css" rel="stylesheet" type="text/css">
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.5.8 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li class="current"><a href="main.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li><a href="annotated.html"><span>Data&nbsp;Structures</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
</div>
<div class="contents">
<h1>Welcome to the documentation for the library LITM -- 0.5</h1>
<p>
The library serves as a <b>Lightweight Inter-Thread Messaging</b> under Linux/Unix.<h2><a class="anchor" name="Dependencies">
Dependencies</a></h2>
<b>Mandatory</b><p>
<ul>
<li>libpthread</li></ul>
<p>
<b>Optional</b> The following components are only required if building from source:<p>
<ul>
<li>scons</li></ul>
<p>
<ul>
<li>python package "pyjld.os" (available through <em>easy_install</em>)</li></ul>
<h2><a class="anchor" name="Example_Usage">
Example Usage:</a></h2>
<h3><a class="anchor" name="Example_Opening">
Opening a connection</a></h3>
<div class="fragment"><pre class="fragment">                                <a class="code" href="struct__litm__connection.html">litm_connection</a> *conn;
                                <a class="code" href="litm_8h.html#a1c70492a41df506aa1156ea7d36c4de">litm_code</a> code = <a class="code" href="connection_8c.html#1c62b68cf084828184eed29d17c6498c">litm_connection_open</a>( &amp;conn );
                                <span class="keywordflow">switch</span>(code) {
                                 <span class="keywordflow">case</span> <a class="code" href="litm_8h.html#9b8b4b198f82bf2ad2eea38062d622930b651a4f84388b526d32980e3b43c4a2">LITM_CODE_OK</a>:
                                                <span class="comment">// can start using the connection</span>
                                                <span class="keywordflow">break</span>;
                                 <span class="keywordflow">case</span> <a class="code" href="litm_8h.html#9b8b4b198f82bf2ad2eea38062d622939fd144765aaaf968cb7a7b7fa847a278">LITM_CODE_BUSY</a>:
                                                <span class="comment">// better try again later</span>
                                                <span class="keywordflow">break</span>;
                                 <span class="keywordflow">default</span>:
                                                <span class="comment">//something is wrong...</span>
                                                <span class="keywordflow">break</span>;
                                }
                                <span class="comment">// if everything is OK, create our worker thread</span>
                                params-&gt;conn = conn; <span class="comment">// pass along the LITM connection identifier</span>
                                pthread_t thread;
                                pthread_create( &amp;thread, NULL, &amp;thread_fnction, (<span class="keywordtype">void</span> *) &amp;params );
</pre></div><h3><a class="anchor" name="Example_Subscribing">
Subscribing to a _bus_</a></h3>
<div class="fragment"><pre class="fragment">                                <span class="comment">// subscribing to bus #1</span>
                                <a class="code" href="litm_8h.html#a1c70492a41df506aa1156ea7d36c4de">litm_code</a> code = <a class="code" href="litm_8c.html#1c8191e4aca778b346954933c7bdf3ff">litm_subscribe</a>(conn, 1);
                                  ... check <span class="keywordflow">return</span> code ...
</pre></div><h3><a class="anchor" name="Example_Sending">
Sending a message on a _bus_</a></h3>
<div class="fragment"><pre class="fragment">                                <span class="comment">// litm connection should be passed through the thread params</span>
                                <span class="keywordtype">void</span> *thread_function(<span class="keywordtype">void</span> *params) {

                                        <span class="keywordtype">void</span> *message; <span class="comment">// whatever structure</span>
                                        <a class="code" href="litm_8h.html#a1c70492a41df506aa1156ea7d36c4de">litm_code</a> code = <a class="code" href="litm_8c.html#bed13398c1bc31a6c81c3e50997e2f2c">litm_send</a>(conn, bus_id, message, NULL);
                                         ... check <span class="keywordflow">return</span> code ...

                                        ...

                                }<span class="comment">//thread_function</span>
</pre></div><h3><a class="anchor" name="Example_Sending_Shutdown">
Sending a message on a _bus_ and initiating shutdown</a></h3>
The following will send a message around the _bus_ and once all active subscribers have released the message, _litm_ will terminate its _switch_ thread.<p>
<div class="fragment"><pre class="fragment">                                <span class="comment">// litm connection should be passed through the thread params</span>
                                <span class="keywordtype">void</span> *thread_function(<span class="keywordtype">void</span> *params) {

                                        <span class="keywordtype">void</span> *message; <span class="comment">// whatever structure</span>
                                        <a class="code" href="litm_8h.html#a1c70492a41df506aa1156ea7d36c4de">litm_code</a> code = <a class="code" href="litm_8c.html#9e932bb687ba4087d90eca7aa6583f0a">litm_send_shutdown</a>(conn, bus_id, message, NULL);
                                         ... check <span class="keywordflow">return</span> code ...

                                        ...

                                }<span class="comment">//thread_function</span>
</pre></div><h3><a class="anchor" name="Example_Receiving">
Receiving a message</a></h3>
<div class="fragment"><pre class="fragment">                                        ... inside the thread_function ...

                                        <a class="code" href="struct__litm__envelope.html">litm_envelope</a> *envelope;
                                        <a class="code" href="litm_8h.html#a1c70492a41df506aa1156ea7d36c4de">litm_code</a> code = <a class="code" href="litm_8c.html#2b6bffa08706c97ea5d9f6d670f8b359">litm_receive_nb</a>(conn, &amp;envelope);
                                         ... check <span class="keywordflow">return</span> code ...

                                        <span class="keywordtype">void</span> *msg;
                                        msg = <a class="code" href="litm_8c.html#aeb4655eae7753e131a710ff5a64b9f7">litm_get_message</a>( envelope );

                                         ... process message WITHOUT MODIFYING IT ...

                                        <span class="comment">// return the envelope to LITM</span>
                                        code = <a class="code" href="litm_8c.html#21def412c9b064fc929e0822f28d2a2a">litm_release</a>(conn, envelope);
</pre></div><h2><a class="anchor" name="Connecting_Subscribing">
Connecting and Subscribing</a></h2>
<div align="center">
<img src="inline_mscgraph_1.png" alt="inline_mscgraph_1" border="0" usemap="#inline_mscgraph_1.map">
<map name="inline_mscgraph_1.map"></map>
</div>
<h2><a class="anchor" name="Sending_Receiving">
Sending and Receiving process</a></h2>
<div align="center">
<img src="inline_mscgraph_2.png" alt="inline_mscgraph_2" border="0" usemap="#inline_mscgraph_2.map">
<map name="inline_mscgraph_2.map"></map>
</div>
<h2><a class="anchor" name="Shutdown">
Shutdown process</a></h2>
<div align="center">
<img src="inline_mscgraph_3.png" alt="inline_mscgraph_3" border="0" usemap="#inline_mscgraph_3.map">
<map name="inline_mscgraph_3.map"></map>
</div>
<h2><a class="anchor" name="Release_Notes">
Release Notes</a></h2>
<h3><a class="anchor" name="release_0_1">
Release 0.1</a></h3>
<ul>
<li>Initial release</li>
</ul>
<h3><a class="anchor" name="release_0_2">
Release 0.2</a></h3>
<ul>
<li>Added litm_receive_wait function</li>
</ul>
<h3><a class="anchor" name="release_0_3">
Release 0.3</a></h3>
<ul>
<li>Added 50ms sleeping in switch thread </li>
<li>Added _queue_put_head_ support for high priority messaging </li>
<li>Added _litm_send_shutdown_ function: coordinated shutdown</li>
</ul>
<h3><a class="anchor" name="release_0_4">
Release 0.4</a></h3>
<ul>
<li>Notable speed increase (added forced interleaving of client threads through usleep) </li>
<li>Added support for quicker shutdown procedure (put shutdown message at ``head`` of queue(s)) </li>
<li>Removed litm_shutdown function </li>
<li>Added coordination for all <a class="el" href="structqueue.html">queue</a> activity through pthread condition variable: no useless blocking</li>
</ul>
<h3><a class="anchor" name="release_0_5">
Release 0.5</a></h3>
<ul>
<li>Fixed deb package control files</li>
</ul>
<dl compact><dt><b><a class="el" href="todo.html#_todo000001">Todo:</a></b></dt><dd>Better connection close</dd></dl>
</div>
<hr size="1"><address style="text-align: right;"><small>Generated on Tue May 26 11:33:57 2009 for LITM by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.5.8 </small></address>
</body>
</html>
